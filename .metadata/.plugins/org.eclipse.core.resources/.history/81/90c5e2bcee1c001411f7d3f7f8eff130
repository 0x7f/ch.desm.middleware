package ch.desm.middleware.modules.communication.message;

import java.util.ArrayList;
import java.util.Arrays;

import ch.desm.middleware.modules.communication.endpoint.serial.ubw32.EndpointUbw32RegisterAnalog;
import ch.desm.middleware.modules.component.cabine.re420.maps.Re420MapUbw32Analog;

public class MessageFabisch extends MessageUbw32Base {

	public MessageFabisch(String payload, String topic) {
		super(payload, topic);

		this.parsePayload(payload);
	}

	/**
	 * 
	 * @param payload
	 *            (IA,3,0,1IA,174,175)
	 */
	protected void parsePayload(String payload) {

		payload = payload.substring(payload.lastIndexOf("A,")+2, payload.length());
		String parts[] = payload.split(",");

		ArrayList<String> list = new ArrayList<String>(Arrays.asList(parts));

		int nrPorts = Integer.toBinaryString(Integer
				.valueOf(Re420MapUbw32Analog.PINBITMASK_INPUT_ANALOG)).length();

		int i=0;
//		while (!list.isEmpty()) {
//
//
//		}
	}

	/**
	 * 
	 */
	@Override
	public String getInputValue(String register, String pin) {
		String value = "";

        if (register.equals("B0")) {
            value = portAN0.getAverageValue();
        } else if (register.equals("B1")) {
            value = portAN1.getAverageValue();
        } else if (register.equals("B2")) {
            value = portAN2.getAverageValue();
        } else if (register.equals("B3")) {
            value = portAN3.getAverageValue();
        } else if (register.equals("B4")) {
            value = portAN4.getAverageValue();
        } else if (register.equals("B5")) {
            value = portAN5.getAverageValue();
        } else if (register.equals("B6")) {
            value = portAN6.getAverageValue();
        } else if (register.equals("B7")) {
            value = portAN7.getAverageValue();
        } else if (register.equals("B8")) {
            value = portAN8.getAverageValue();
        } else if (register.equals("B9")) {
            value = portAN9.getAverageValue();
        } else if (register.equals("B10")) {
            value = portAN10.getAverageValue();
        } else if (register.equals("B11")) {
            value = portAN11.getAverageValue();
        } else if (register.equals("B12")) {
            value = portAN12.getAverageValue();
        } else if (register.equals("B13")) {
            value = portAN13.getAverageValue();
        } else if (register.equals("B14")) {
            value = portAN14.getAverageValue();
        } else if (register.equals("B15")) {
            value = portAN15.getAverageValue();
        }

		return value;
	}

	/**
	 * TODO implementation
	 */
	public String toString() {
		String s = super.toString();
		s += "PortAN0: " + portAN0;
		s += "PortAN1: " + portAN1;
		s += "PortAN2: " + portAN2;
		s += "PortAN3: " + portAN3;
		s += "PortAN4: " + portAN4;
		s += "PortAN5: " + portAN5;
		s += "PortAN6: " + portAN6;
		s += "PortAN7: " + portAN7;
		s += "PortAN8: " + portAN8;
		s += "PortAN9: " + portAN9;
		s += "PortAN10: " + portAN10;
		s += "PortAN11: " + portAN11;
		s += "PortAN12: " + portAN12;
		s += "PortAN13: " + portAN13;
		s += "PortAN14: " + portAN14;
		s += "PortAN15: " + portAN15;

		return s;
	}
}

package ch.desm.middleware.modules.communication.endpoint.virtual;

import java.util.Hashtable;

import org.apache.log4j.Logger;

import ch.desm.middleware.modules.core.daemon.DaemonThread;

class EndpointInterlockingLogicPolling extends DaemonThread {

	protected static Logger log = Logger.getLogger(EndpointInterlockingLogicPolling.class);
	
	InterlockingPetriNet net;
	private Hashtable<String, Boolean> map;
	
	public EndpointInterlockingLogicPolling(String name, InterlockingPetriNet net) {
		super(name);
		this.map = new Hashtable<String, Boolean>();
		this.net = net;
		
		net.writeActors();
		net.init();
		
		this.start();
	}
	
	/**
	 * 
	 */
	@Override
	public void run() {
		while (!isInterrupted()) {
			  Boolean value = net.fireOneTransition();
			  String key = net.getFiredElement();
			  map.put(key, value);
			  log.info("key: " +key+ ", value: " + value);
		}
	}

}
